# Headline

Private Certificate Authority Requirements

# Behavior

## SEC-509-CA-FR1: Private CA Certificate Creation

When an offering generates a [Private Certificate Authority](#DEF_PrivateCertificateAuthority) as part of its function, the offering:

1. _MUST_ generate all certificate keypairs using the strongest random number generation methods available and follow the requirements of SEC-CRY-RANDOM.

2. _SHOULD_ generate a three-tier architecture, with a dedicated root keypair that is only used to sign an issuing CA keypair and an issuing CA keypair only used to sign leaf/end-entity certificates. The root keypair _SHOULD_ NOT be available for network-based signature requests and _SHOULD_ require the offering operator to manually initiate signing of issuing CAs after the initial issuing CA signature is complete.

## SEC-509-CA-FR2: Private CA Certificate Properties

Private Certificate Authorities must ensure that they do not create a hidden point of failure for product operation. To accomplish this, the Private CA:

1. _MUST_ be generated with at least a five-year lifetime on all CA certificates (root and any issuing CA certificates created).

2. _MUST_ warn the operator using visible notifications about the pending expiration of *any* CA certificates in use at least 365 days prior to expiration. Expiration notices _MUST_ also be provided at 180 days, 90 days, 30 days, and 14 days prior to expiration.


## SEC-509-CA-FR3: Private CA Issuance

**(Partially from SEC-509-FQDN-FR1)

Private Certificate Authorities must ensure they issue RFC-compliant certificates using current issuance technologies to ensure support for customer environments. To accomplish this, the Private Certificate Authority:

1. _MUST_ generate certificates compliant with RFC 5280 and any superseding RFCs issued by the IETF for X.509 certificates.
2. _MUST_ include at least one Subject Alternative Name entry in issued certificates *that are intended for use in TLS*, containing the certificate subject. Internal CAs _MAY_ issue certificates without a Common Name (CN) field; in the event that they issue certificates *with* a Common Name (CN) field entry, this entry _MUST_ also be replicated as a Subject Alternative Name (SAN) entry.
3. _SHOULD_ support automated issuance and renewal of certificates using an industry standard protocol such as REST, ACME, EST, or SCEP. When an Private Certificate Authority supports SCEP for issuance, it _MUST_ also support at least one other automated protocol, and _SHOULD_ not default to using SCEP for issuance.

## SEC-509-CA-FR4: Private CA Certificate Lifetimes

**(Was SEC-509-LIFETIME-FR1)**

Private Certificate Authorities must ensure they issue certificates whose validity dates (delta between NotBefore and NotAfter) meet the following standards:

| Certificate purpose | Subject type | [Minimum life](#DEF_MinLife) | [Recommended life](#DEF_RecLife) | [Maximum life](#DEF_MaxLife) |
| --- | --- | --- | --- | --- |
| Private Peer Certificate - TLS | FQDN / X.500 Domain Name | N/A | 1 year | 2 years |
| SAML OAUTH Assertion Certificate | FQDN / X.500 Domain Name | 1 years | 5 years | 10 years |
| CA Certificate (self-generated) | X.500 Domain Name | 5 years | 5 years | 10 years |
| CA Certificate (service) | X.500 Domain Name | 5 years | 15 years | 30 years |
| Manufacturer Device Identity / SUDI Peer Certificate | FQDN / Serial | 5 years | infinite (expire 99991231235959Z) | N/A |
| Manufacturer Device Identity / SUDI Certificate Authority | X.500 Domain Name | 10 years | infinite (expire 99991231235959Z) | N/A |

**Supplemental Guidance**:

1. The [CA/Browser Forum](https://cabforum.org) Baseline Standards for the issuance of public TLS certificates mandate that public TLS certificates not have a lifetime greater than 398 days. In addition, certain browser vendors (e.g., Apple) have mandated this lifetime in their browser software for *all* TLS certificates whether the certificate chain is publicly trusted or not. For this reason, private TLS certificates generated by Cisco products or services SHOULD have a maximum lifetime of no more than 398 days, or one year. Since Cisco entities do not have control over the length of certificates issued to them by public TLS authorities, no guidance or requirements are given for those certificates under this standard.
2. The term "CA Certificate (self-generated)" refers to products/offerings that generate an internal Certificate Authority as part of normal function—e.g., a Kubernetes cluster that generates its own internal CA or a router generating a CA at the direction of a customer. The term "CA Certificate (service)" refers to a persistent CA service operated by Cisco Systems as part of a service offering—e.g., a private CA created inside a cloud service offering to authenticate customer consumers of that offering.
3. Certificate Authority Certificate lifetimes provided in the table above ONLY apply to certificate authorities controlled or operated by Cisco Systems. They specifically DO NOT apply to the lifetimes of public certificate authorities operated by third parties that are included in trust bundles or trust stores incorporated into Cisco products. For example, no PSB violation is created by including in a product trust store a public certificate authority from DigiCert whose maximum lifetime exceeds 30 years.
4. For SUDI/Manufacturer Identity certificates, the common understanding within Cisco’s manufacturing and issuance processes is that these certs live forever. They stay in the device and are never revoked. Certificates issued for the purposes of SUDI/Device Identity therefore have no maximum lifetime limit on either the Peer Certificate or the lifetime of the Certificate Authority.

## SEC-509-CA-FR5: Private CA Certificate Revocation

**(Was SEC-509-REVOKE-FR1, SEC-509-REVOKE-FR3)**

Private Certificate Authorities must ensure they support the responsible revocation of certificates. To accomplish this:

1. Private Certificate Authorities _MUST_ support revocation of end-entity AND issuing CA certificates and _SHOULD_ enable this option by default.
2. If revocation is supported, the CA _MUST_ include OCSP *or* CRL information in all generated certificates. The CA _MAY_ include both OCSP and CRL information in certificates if both are used.
3. Any OCSP or CRL URI provided by the offering in certificates _MUST_ be reachable from the entities validating the issued certificates. 
4. If certificates from the CA include a revocation URI for a Certificate Revocation List (CRL):
   1. This CRL file _MUST_ be updated by the Internal CA regularly at least two days prior to the expiration of the current CRL.
   2. This URI _SHOULD_ be placed in the CRLDistributionPoints extension, following RFC 5280.
   3. The Internal CA _MAY_ include or support a revocation URI hosted by the offering itself. In this case, the Internal CA _MUST_ automatically update the CRL at this URI at least two days prior to the expiration of the current CRL.
   4. The Internal CA _MAY_ include or support a revocation URI not hosted by the offering itself. In this case, the Internal CA _MUST_ make a new CRL file available to offering operators for upload at least two days prior to the expiration of the current CRL.
5. If certificates from the CA include a revocation URI for Online Certificate Status Protocol (OCSP) queries:
   1. The offering _MUST_ ensure OCSP information remains available at the URI embedded in the certificate and that the information remains current throughout the lifetime of the issued certificate.
   2. The offering _MUST_ generate OCSP responses using a key or keys separate from the certificate signing key and authorize these keys using certificates containing the id-kp-OCSPSigning extended key usage extension as described in RFC 6960, section 4.2.2.2. 
   3. This URI _SHOULD_ be placed in the AIA extension, following RFC 4325.
   4. Responses generated by the TLS server certificates _MAY_ include a non-critical, OCSP "must staple" extension (RFC7633), but _MUST NOT_ incorporate this attribute unless included in the requester's Certificate Signing Request (CSR).

**Exception:**

1. If the Private CA issues certificates with a standard lifetime of 7 days or less, it _SHOULD_ support revocation of these certificates but is not required to. However, it _MUST_ still support revocation of any Issuing CAs that are part of the Internal CA chain.
2. Private CAs that issue certificates not intended to be revoked or whose certificate ecosystems do not support the use of revocation (for instance, [Device Identity Certificates](#DEF_DeviceIdentityCertificate))_MAY_ omit support for revocation.

## SEC-509-CA-FR6: Private CAs Intended for Customer Operation

Offerings that are intended to be operated by a customer on customer premises (e.g., hardware products or software packages) will sometimes include the option for the product to generate an internal Certificate Authority to act as a root of trust for the product. This feature must ensure that the CA itself is generated and maintained securely, and that the customer is offered the option to offload this functionality to an external CA of the customer's choice. To accomplish this, Private Certificate Authorities incorporated into offerings that are intended to be operated by a Cisco Customer on Customer Premises:

1. _MUST_ offer the operator the option to export the CA keypairs from the product for backup purposes. This backup export _MUST_ be protected by encryption prior to making the backup file(s) available to the offering operator.
2. _MUST_ support the ability to import an existing keypair for the root CA, either from an encrypted root CA backup or from a manually supplied keypair imported by the operator.
3. _MUST_ support the ability to regenerate any CA certificate keypairs individually and separately at the request of the operator.
4. _MUST_ permit the operator to select a lifetime on the CA during the generation process.
5. _MUST_ warn the operator using visible notifications about the pending expiration of *any* CA certificates in use at least 365 days prior to expiration. Expiration notices _MUST_ also be provided at 180 days, 90 days, 30 days, and 14 days prior to expiration.

Note that all of the above requirements in FR1 through FR4 *still apply to these certificate authorities* unless specifically superseded by the requirements in FR5.

**Exception:**

1. Some Cisco products incorporate Private Certificate Authority code authored by upstream projects—for instance, a product which incorporates a copy of Kubernetes may include and leverage the Kubernetes default root CA code. Offerings incorporating upstream certificate authority software _SHOULD_ review it for compliance with these requirements. These CAs are not required to comply with these requirements *IF AND ONLY IF* the certificates issued are used only within the product itself and cannot be leveraged by outside entities. For instance, a Kubernetes CA that issues certificates to its own containers is not considered in scope for these requirements *as long as* the certificates issued by it are not used outside the Kubernetes cluster itself.

## SEC-509-CA-FR7: Private Certificate Authorities in Cisco-Operated Offerings

Offerings that are operated by Cisco itself, such as a cloud service for customer consumption, will sometimes incorporate the use of a Private Certificate Authority. It is crucial that these certificate authorities be operated in a secure and responsible manner, and that they not create additional points of failure within a service.

1. The offer team _MUST_ first evaluate the Private CA offerings provided by the Cisco Security and Trust Organization before the team decides to deploy their own private CA. For a list of the Private CA offerings by S&TO Cryptographic Services, refer to the STO [service offerings page](https://cswiki.cisco.com/display/EXT/04+++Private+PKI).
2. Groups that cannot use the S&TO-provided private certificate services _MAY_ operate a Private Certificate Authority. In this case:
   1. The group operating the service offering _MUST_ provide an attestation, in the form of a short EDCS document in Doc Central, documenting all of the following, and provide the document link to ciscopki@cisco.com for review/approval:
      * The reasons for operating a private certificate authority other than the S&TO CCS-provided services;
      * A copy of the root CA certificate or certificates to be used;
      * A description of the CA operation, environment, and controls describing compliance with the Cryptographic Controls Policy (EDCS-806748).
      * A limited scope such as a specific DNS sub-domain, product-related DNS domain, or acquisition domain for which certificates will be issued and managed;
      * A reliable, registered emergency contact system for the product or service team / BU for responding to issues with certificates (this may be integrated into other incident response programs so long as they have specific playbooks for certificate-related problems).
   2. The Private Certificate Authority _MUST_ conform to the specifications in the 'Customer-Operated Offerings' section above If the Private Certificate Authority will issue certificates to hosts or entities under the customer's control.
   3. If the Private Certificate Authority will only issue certificates to components of the offering also operated by Cisco AND the offering automatically creates and operates the Internal CA as part of normal software operations, the offering _MAY_ use this Internal CA *IF AND ONLY IF* certificates issued by it are not exposed outside of the offering's control or to customer-operated components.  
   For example, Kubernetes creates a Private CA as part of cluster creation. This Private CA MAY be used by a Cisco-operated offering as part of operations without the above documentation requirements, as long as the certificates issued by the Kubernetes CA are NOT exposed to customers or outside of the Kubernetes cluster itself.
   4. The operation of an Private Certificate Authority by a Cisco team _MUST_ conform to Cisco's Cryptographic Controls Policy, which likely will require review and approval by S&TO Cryptographic Services.

# Normative References

- Cisco Cryptographic Controls Policy,
[EDCS-806748](https://docs.cisco.com/share/proxy/alfresco/url?docnum=EDCS-806748)

# Requirement References

    ---
    foreign_id: SEC-509-TRUST
    relation: connects
    headline: |-
      SEC-509-TRUST
              constrains which CAs you (and other offerings)
              can accept by
              default.
              SEC-509-CACHOICE requires that any CA you
              use to generate or present certificates
              meet the same constraints.
    source: PSB
    ---
    foreign_id: SEC-509-VALIDATE
    relation: connects
    headline: |-
      SEC-509-VALIDATE describes the
              methods that must be used to validate an X.509 certificate as well as appropriate lifetimes.
              It also requires your CA to support revocation and OCSP.
    source: PSB
    ---
    foreign_id: SEC-CRY-PRIM-FR1
    relation: connects
    headline: |-
      SEC-CRY-PRIM-FR1 requires
              your CA to support appropriate cryptographic
              primitives.
    source: PSB
    ---
    foreign_id: SEC-OUT-CRED
    relation: connects
    headline: |-
      SEC-OUT-CRED
              forbids "hardwired" certificates that are
              the same in every instance of your
              offering.
    source: PSB
    ---
    foreign_id: SEC-AUT-CREROT
    relation: connects
    headline: |-
      SEC-AUT-CREROT
              Support real-time credentials rotation or renewal functionality.
    source: PSB

# History

```yaml

```

# Attributes
    phase: requirements
    legallysensitive: false
    priority: 8
    applicability:
    - force: mandatory
      target:
        restrict: >
          offerings that issue or generate certificates
    category: Cryptographic Support
    riskArea: Cryptography, Encryption & Key Management
    waivable: true
    version: 1
    id: SEC-509-CA
    issueref: ISS_X509Valid
    tags:
    - EN/PI
    - PSB/OnPrem
    - Cloud
    - FAST
