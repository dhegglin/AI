# Headline

Send security logs to a centralized log system

# Key Benefits

A centralized log systems allows for more efficient analysis of events and investigation as part of incident response and audit reviews.

# Description

Create a central point at which to collect all security-relevant logs
generated by any part of your [offering](#DEF_Offering).

Security-relevant logs may be generated by infrastructure, host, middleware, and applications events.
Instead of attempting to segregate these different layers of the stack, centralize them into
a common Security Information Event Manager (SIEM).

# Behavior

## SEC-LOG-CENTRAL-FR1: Centralization

Combine all log data demanded by any PSB requirement, and any other
log data which you identify as being of security interest, at an
existing central log collector, or at a central collector within
your [offering](#DEF_Offering). You _MAY_ send other
non-security-related logs to the same collector.

Relevant log data can be generated by any part of
your [offering](#DEF_Offering), its supporting infrastructure, or
anything involved in protecting any of
its [controlled space](#DEF_ControlledSpace), including but not limited
to:

* application code
* host operating systems
* infrastructure services
  * database managers
  * firewalls
  * intrusion detection systems
  * network devices
  * physical access control systems

## SEC-LOG-CENTRAL-FR2: Timeliness

The log data associated with each event _MUST_ be available at the central
collector within five minutes of that event's detection.

## SEC-LOG-CENTRAL-FR3: Accessibility

It _MUST_ be possible to query and extract information at the central
collector based on any of the information fields required
by [SEC-LOG-CONTENT](#SEC-LOG-CONTENT).

Any data delivered to the central collector in structured form (JSON,
attribute-value pairs, ASN.1, XML, etc) _MUST_ be accessible using
structured queries. In other words, the logging system _MUST_
understand that one part of the record is the date field, another part
is the originating host, etc, and _MUST_ allow that information to be
used to build queries.

If part or all of an event record is delivered to the central
collector in an unstructured form such as free text, it _MUST_ at a
minimum be possible to use regular expression searches to identify the
needed messages with reasonable certainty.

You _SHOULD_ take advantage of all options available in your chosen
environment(s) to make it easy and efficient to query, filter,
classify, correlate, and otherwise analyze log data.

The central collector _SHOULD_ be able to forward filtered streams of
logging data to other consumers in real time, using common logging
protocols. It _SHOULD_ be possible to filter these streams using
either structured or full-text criteria.

## SEC-LOG-CENTRAL-FR4: Access Control

Logs _MUST_ be protected against unauthorized viewing and/or
modification, just as for any [sensitive](#DEF_Sensitive) data. The zone
definition required by [SEC-INF-FIREWALL](#SEC-INF-FIREWALL) is
particularly relevant for a centralized logging service.

Users not authorized to use logs _MUST_NOT_ have any access to the
central collector. Authorization to view or otherwise use data from
logs _MUST_ be granted separately from any access which could permit
modifying or deleting log data.

It _SHOULD_ be possible to control access to specific logging data
according to the following criteria (these are attributes of the
_data_, not necessarily attributes of the person _using_ the data):

1. Affected tenant, if the originating system identified an affected
   tenant, or if the affected tenant can be reliably inferred from
   other information such as server hostnames.
1. Any username or other [principal](#DEF_Principal) name associated
   with the event. Note that in some systems user/principal name
   spaces may be tenant-specific, which means that a principal name
   may only be meaningful if the appropriate tenant name is also
   known.
1. If certain organizational roles are responsible for handling
   specific types of events, then the event type or corresponding
   role(s). Authorized access to logging systems and data, and the use
   of such access, _MUST_ be subject to periodic auditing.

## SEC-LOG-CENTRAL-FR5: Enterprise Offerings (Condition: Force:Mandatory, Restrict:Enterprise)

Enterprise offerings _MUST_ collect security events to a centralized logging facility or event manager.

1. IT-Managed Environment:
  * Infrastructure logs from VMs are sent to IT Splunk servers
  * Applications are configured for centralized log monitoring
  * OR

1. If a centralized logging system is operated by a team other than IT or CSIRT, the logging system _MUST_ be:
  * registered in the Enterprise Service Portfolio as a Business Application.
  * certified following the CSDL for Enterprise process.
  * specifically evaluated against the requirements in SEC-LOG-CENTRAL-FR1 thru FR4.

# Informative References

* RECIPE: [Log Security-relevant Information](https://cisco.sharepoint.com/Sites/CiscoProductSecurityCookbook/SitePages/Log%20SecurityRelevant%20Information.aspx)
* RECIPE: [Application Logging and Monitoring](https://cisco.sharepoint.com/Sites/CiscoProductSecurityCookbook/SitePages/ASLR%20in%20Linux%20Systems.aspx)
* RECIPE: [Validate Logging Implementation](https://cisco.sharepoint.com/Sites/CiscoProductSecurityCookbook/SitePages/Validate%20Logging%20Implementation.aspx)
* Prerequisite for [SEC-INF-MONITOR](#SEC-INF-MONITOR)

# Requirement References

    ---
    source: PSB
    foreign_id: SEC-LOG-CONTENT
    relation: connects
    headline: >
        [SEC-LOG-CONTENT](#SEC-LOG-CONTENT)describes the information to be
        included in log messages. SEC-LOG-CENTRAL requires that the
        central logging collector be able to query based on that
        information.
    ---
    source: PSB
    foreign_id: SEC-LOG-PROTO
    relation: connects
    headline: >
        [SEC-LOG-PROTO](#SEC-LOG-PROTO)lists logging protocols which the
        central collector must support.
    ---
    source: PSB
    foreign_id: SEC-LOG-CHANGES
    relation: connects
    headline: >
        [SEC-LOG-CHANGES](#SEC-LOG-CHANGES)requires you to detect and log
        changes to the logged data or logging configuration.
    ---
    source: PSB
    foreign_id: SEC-INF-FIREWALL
    relation: connects
    headline: >
        [SEC-INF-FIREWALL](#SEC-INF-FIREWALL)requires network segmentation. It
        may often be appropriate for logging to have a dedicated zone.
    ---
    source: PSB
    foreign_id: SEC-AUT-LOG
    relation: connects
    headline: >
        [SEC-AUT-LOG](#SEC-AUT-LOG)requires logging all sessions, _including
        sessions for access to the central logging collector itself_ .
    ---
    source: PSB
    foreign_id: SEC-OPS-RDY
    relation: connects
    headline: >
        [SEC-OPS-RDY](#SEC-OPS-RDY)requires establishing procedures for
        granting, revoking, and auditing access to logs (and everything else).
    ---
    source: ISO 27002:2013
    foreign_id: A.12.4.1
    foreigntarget: 12
    relation: connects
    headline: >
        ISO 27002:2013: A.12.4.1 Event logging
    ---
    source: ISO 27002:2013
    foreign_id: A.12.4.2
    foreigntarget: 12
    relation: connects
    headline: >
        ISO 27002:2013: A.12.4.2 Protection of log information
    ---
    source: ISO 27002:2013
    foreign_id: A.12.4.3
    foreigntarget: 12
    relation: connects
    headline: >
        ISO 27002:2013: A.12.4.3 Administrator and operator logs
    ---
    source: ISO 27002:2013
    foreign_id: A.16.1
    foreigntarget: 16
    relation: connects
    headline: >
        ISO 27002:2013: A.16.1.1 Management of information security incidents
        and improvements: Responsibilities and procedures
# History

```yaml
-----
affected_psb: SEC-LOG-CENTRAL-4
description:  Added Recipe links.
---
```
# Attributes

    id: SEC-LOG-CENTRAL
    version: 4
    category: Logging and Auditing
    riskArea: Logging & Monitoring
    legallysensitive: false
    waivable: true
    issueref: ISS_LogScatter
    applicability:
      - force: mandatory
        target:
          class: ServiceThing
          restrict: >
            services
    priority: 8
    phase: requirements
    tags:
    - CloudCritical
    - Cloud
