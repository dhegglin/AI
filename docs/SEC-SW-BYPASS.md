# Headline

Provide per-instance bypass for user products that include GPLv3 licensed code closed software

# Key Benefits
Provides a mechanism for securely implementing the user modification requirements of the GPLv3 license.


# Description
Licensing under GPLv3 requires that, for a User Product, the user be permitted to load and run a modified version of its corresponding source code, and that the continued functioning of the modified object code is in no case prevented or interfered with solely because modification has been made.'

So if a Cisco product is deemed a "user product" (one that is designed or reasonably could be used in homes - consult your Cisco Legal contact for more details), you cannot use GPLv3-licensed software in it unless you provide the user with the ability to bypass it with alternate software of their choosing.

# Behavior

If you're building what the GPL calls a "user product", it either _MUST_ not include GPLv3 licensed code, or _MUST_ provide a way to bypass checking for a user wishing to load a modified version of that code.

A "user product" in GPL is poorly defined, with a great deal of room for interpretation that favors a broad definition.  If a Cisco product is designed to or can reasonably be expected to be used in a home (e.g. small office devices) consider it a "user product".

If it is impossible to enable a bypass such that the user is able to run alternate software without compromising the overall security of the product, then either a) select a component that is not GPLv3-licensed or b) contact legal to evaluate whether the “user product” issue is relevant to your product.

## SEC-SW-BYPASS-FR1:  Provide a means to bypass load checking on GPLv3-licensed software
For all covered [closed](#DEF_Closed)[code](#DEF_Code) there _MUST_ be
a means of bypassing or replacing the cryptographic checks which assure
that the [code](#DEF_Code) comes from or is approved by Cisco or any
other supplier. There _MUST_ be a way of escaping the verification
required by [SEC-SW-LOADCHK](#SEC-SW-LOADCHK).

This bypass system _MUST_ have the following properties:

1.  It must demand using a bypass token specific to the individual,
    physical unit being unlocked. This token _MUST_NOT_ be usable on
    any other instance of the [product](#DEF_Product).

2.  Cryptographic checks _MUST_ assure that creating a working bypass
    token requires both of the following.

    1.  A private cryptographic key HELD only by Cisco, and validated by
        an X.509 certificate chain rooted at Cisco's certificate
        authority.

    2.  A request block generated by the unit to be unlocked,
        identifying that specific unit, and cryptographically signed
        using a factory-installed device identity certificate issued
        only to that unit.

3.  Neither the bypass token nor the request block may be pregenerated;
    both _MUST_ be created only upon specific user request.

4.  The unit _MUST_NOT_ generate a request block unless the
    requesting user demonstrates physical access to the hardware.

5.  The bypass token _MUST_ permit the user either to replace the
    cryptographic key used in the verification step required in
    [SEC-SW-LOADCHK](#SEC-SW-LOADCHK) with a user key (the Instance Specific Replacement
    Key in the standard scheme), or to provide an additional user key
    which will also be accepted. The user key may be generated by the
    device, or may be provided by the user.

    1.  The public side of the replacement key _MUST_ be securely
        embedded in the token request block and in the bypass token
        itself, and _MUST_ be covered by the cryptographic signatures
        in both directions.

    2.  The signing mechanism _MUST_ be such that the user can sign
        software using readily available tools, whether provided by
        Cisco or found elsewhere. This _SHOULD_ include the capability
        to replace the existing Cisco signature on an image with a user
        signature, and _SHOULD_ also include the capability to add a
        user signature without invalidating the Cisco signature.

6.  Using the bypass key _SHOULD_ permanently alter the affected unit
    in such a way that [code](#DEF_Code) running on the affected unit
    itself can determine that the bypass token has been used.

    1.  This alteration _SHOULD_ be done in such a way that it cannot
        be reversed by [open](#DEF_Open)[code](#DEF_Code), or by any
        [code](#DEF_Code) running in the “bypassed[” execution
        space](#DEF_ExecutionSpace). This _MAY_ be done by storing the
        information in [controlled space](#DEF_ControlledSpace)
        maintained by [closed](#DEF_Closed)[base
        software](#DEF_BaseSoftware) not containing GPLv3 code and not
        subject to this requirement, or by the use of a write-once
        hardware “fuse”.

    2.  The standard system software _SHOULD_ support reporting this
        status via a serial console, built-in display, or other purely
        [local](#DEF_Local) means (but note the restriction in the
        following item). This report _SHOULD_ be made by
        [closed](#DEF_Closed)[base software](#DEF_BaseSoftware) not
        containing GPLv3 software and not subject to this requirement.

## SEC-SW-BYPASS-FR2:  Warning of invalidated support
If installing modified software will invalidate any support contracts or warranties, the [product](#DEF_Product) _MUST_ warn the user before generating a request block. If the Cisco verification key is to be completely replaced by a device-specific verification key (as with the Instance Specific Replacement Keys of the standard scheme), the [product](#DEF_Product) _MUST_ warn the user that Cisco-supplied software images will have to be re-signed to enable their installation once the bypass token has been used.

 ## SEC-SW-BYPASS-FR-3:  Invisibility of modifications
There _MUST_NOT_ be any assured way for outside devices to determine whether or not a bypass token has been used. It _MUST_ be possible for user-provided replacement [code](#DEF_Code), or for the user him- or herself, to modify the system to report to outside devices that the [SEC-SW-APPDTCT](#SEC-SW-APPDTCT) protection has *not* been bypassed.
This includes reports via CLI commands and other [administration](#DEF_Administrator) interfaces, as well as any cryptographic attestation.

# History
```yaml
-----
affected_psb: SEC-SW-BYPASS-2
description:  Updated to functional requirements.  Limited applicability to "user products" as defined in the GPLv3 license
-----
deprecated_psb: SEC-SW-BYPASS
impact: normative
description: >
  Limited applicability to "user products" as defined in the GPLv3 license
  Updated format to functional requirements
---
```

# Attributes

    phase: requirements
    legallysensitive: true
    priority: 8
    applicability:
    - force: mandatory
      target:
        restrict: |-
          closedcode in
                      containing GPLv3-licensed or similarly
                      restricted software and embedded in
                      "user products".
    category: Development Process
    riskArea: CSDL Policy
    waivable: true
    version: 2
    id: SEC-SW-BYPASS
    issueref: ISS_GPLv3TIVO
    tags:
    - EN/PD
    - EN/PI
    - GPLv3
    - PSB/OnPrem
